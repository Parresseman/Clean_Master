<!DOCTYPE html>
<html>
<head>
	<title>Clean master v1.6</title>
	<hta:application id="oMyApp" applicationname="Clean_master" border="thin" INNERBORDER="No" MAXIMIZEBUTTON="No" caption="yes" showintaskbar="yes" singleinstance="yes" SYSMENU="yes" ICON="notepad.exe">
	<!-- <HTA:APPLICATION MAXIMIZEBUTTON="No"> -->
	<meta http-equiv="X-UA-Compatible" content="IE=11" />
	<!-- <meta http-equiv="MSThemeCompatible" content="Yes" /> -->
	<style>
	html,body {
		font-family:calibri;
		color: #FF5A10;
	}
	
	select{

		height: 20px;
		border-radius: 2px;
		border: 1px solid #ededed;

	}
	
	h1,h2 {
	
	font-size: 24px;
	
	}
	.bouton  {
	
		color: #000000;
		background-color: #f0f0f0;	
		padding: 10px 10px;
		border-radius: 2px;
		border-style: none;

	}

	.bouton:hover {

		color: #FFFFFF;
		background-color: #FF5A10;

	}
	
	#form {
	
		margin-left: 20px;
	
	}
	
	#form1, #form2, #form3 {
	
	margin-top: 20px;
	
	}
	
	#Eclipse {
	
	margin-left: 100px;
	
	}
	
	#option {
	
	margin-top: 10px;
	
	}
	
	#bouton, #bouton_migrate {
	
	margin-top: 20px;
	
	}
	
	#bouton_migrate {

	
	}
	
	#warning {
	
	color: red;
	
	}
	
	#FromTo {
	
	margin-top: 50px;
	
	}
	
	#Deploy {
	
	margin-top: 50px;
	
	}
	
	.tx_to {
	
	font-size: 18px;
	font-weight: bold;
	margin-left: 50px;
	margin-right: 50px;
	
	}
	
	#myProgress {
		border-radius: 3px;
		margin-top: 10px;
		width: 100%;
		background-color: #f9f9f9;
		
	}
	#myBar {
		border-radius: 3px;
		width: 0%;
		height: 30px;
		background-color: #FF5A10;
		text-align: center;
		color: white;
		line-height: 30px;
		white-space: nowrap;
	}
	</style>
</head>
<body  onload="window.resizeTo(540,700)">
	<div id="form">
		<h1>
			Choose a calculation to clean:
		</h1>
		<label><input type="checkbox" name="PROD_Input" value="PROD"> PROD </label>
		<label><input type="checkbox" name="ACC_Input" value="ACC"> ACC </label>
		<label><input type="checkbox" name="INT_Input" value="INT"> INT </label>
		<div id="form1">
			<select  Id="id_stress">
				<option value="ALL">ALL</option>
				<option value="BE_VIE">BE VIE</option>
				<option value="BE_VIE_ACT">BE VIE ACT</option>
				<option value="BE_VIE_ACT_1000SIM">BE VIE ACT 1000SIM</option>
				<option value="BE_VIE_ACT_NOVA">BE VIE ACT NOVA</option>
				<option value="BE_VIE_ACT_NOVA_1000SIM">BE VIE ACT NOVA 1000SIM</option>
				<option value="BE_VIE_BLANK_RUN">BE VIE BLANK RUN</option>
				<option value="BE_VIE_CBG">BE VIE CBG</option>
				<option value="BE_VIE_CBG_1000SIM">BE VIE CBG 1000SIM</option>
				<option value="BE_VIE_CBG_NOVA">BE VIE CBG NOVA</option>
				<option value="BE_VIE_CBG_NOVA_1000SIM">BE VIE CBG NOVA 1000SIM</option>
				<option value="BE_VIE_NOVA">BE VIE NOVA</option>
				<option value="CALC_EPIFP_CBG">CALC EPIFP CBG</option>
				<option value="CALC_EPIFP_PSGL">CALC EPIFP PSGL</option>
				<option value="LAT_BEGAAP">LAT BEGAAP</option>
				<option value="LAT_IFRS">LAT IFRS</option>
				<option value="RENTES_DC">RENTES DC</option>
				<option value="SCR_INT_ACT">SCR INT ACT</option>
			</select>
			<!-- <div id="option">
				<label><input type="checkbox" name="SUPPR_batch" value="batch"> Suppression des workflows </label>
			</div> -->
			<div id="bouton">
				<button class="bouton" type="button" onclick="SVN_Clean()">
					Clean SVN
				</button>
				<button class="bouton" type="button" onclick="SVN_Commit()">
					Commit
				</button>
				<button id="Update" class="bouton" type="button" onclick="SVN_Update()">
					Update selected
				</button>
				<button id="Eclipse" class="bouton" type="button" onclick="RUN_eclipse()">
					Run eclipse
				</button>
			</div>
		</div>
		<div id="FromTo">
		<h2>
			Migration option:
		</h2>
			<label><input type="checkbox" name="PROD_From" value="PROD"> PROD </label>
			<label><input type="checkbox" name="ACC_From" value="ACC"> ACC </label>
			<label><input type="checkbox" name="INT_From" value="INT"> INT </label>
			<div id="form2">
				<select  Id="id_stress2">
					<option value="BE_VIE">BE VIE</option>
					<option value="BE_VIE_ACT">BE VIE ACT</option>
					<option value="BE_VIE_ACT_1000SIM">BE VIE ACT 1000SIM</option>
					<option value="BE_VIE_ACT_NOVA">BE VIE ACT NOVA</option>
					<option value="BE_VIE_ACT_NOVA_1000SIM">BE VIE ACT NOVA 1000SIM</option>
					<option value="BE_VIE_BLANK_RUN">BE VIE BLANK RUN</option>
					<option value="BE_VIE_CBG">BE VIE CBG</option>
					<option value="BE_VIE_CBG_1000SIM">BE VIE CBG 1000SIM</option>
					<option value="BE_VIE_CBG_NOVA">BE VIE CBG NOVA</option>
					<option value="BE_VIE_CBG_NOVA_1000SIM">BE VIE CBG NOVA 1000SIM</option>
					<option value="BE_VIE_NOVA">BE VIE NOVA</option>
					<option value="CALC_EPIFP_CBG">CALC EPIFP CBG</option>
					<option value="CALC_EPIFP_PSGL">CALC EPIFP PSGL</option>
					<option value="LAT_BEGAAP">LAT BEGAAP</option>
					<option value="LAT_IFRS">LAT IFRS</option>
					<option value="RENTES_DC">RENTES DC</option>
					<option value="SCR_INT_ACT">SCR INT ACT</option>
				</select>
				<span class="tx_to" >To: </span>
				<label><input type="checkbox" name="PROD_To" value="PROD"> PROD </label>
				<label><input type="checkbox" name="ACC_To" value="ACC"> ACC </label>
				<label><input type="checkbox" name="INT_To" value="INT"> INT </label>
			</div>
		</div>
		<div id="bouton_migrate">
			<button class="bouton" type="button" onclick="SVN_Migration()">
				Migrate
			</button>
			<button class="bouton" type="button" onclick="SVN_Revert()">
				Undo change
			</button>
		</div>
		<div id="Deploy">
		<h2>
			Deployement option:
		</h2>
			<div id="form3">
				<label><input type="checkbox" name="PROD_FromD" value="PROD"> PROD </label>
				<label><input type="checkbox" name="ACC_FromD" value="ACC"> ACC </label>
				<label><input type="checkbox" name="INT_FromD" value="INT"> INT </label>
				<span class="tx_to" >To: </span>
				<label><input type="checkbox" name="PROD_ToD" value="PROD"> PROD </label>
				<label><input type="checkbox" name="ACC_ToD" value="ACC"> ACC </label>
				<label><input type="checkbox" name="INT_ToD" value="INT"> INT </label>
			</div>
		</div>
		<div id="bouton_migrate">
			<button class="bouton" type="button" onclick="SVN_Deploy()">
				Deploy
			</button>
			<button class="bouton" type="button" onclick="SVN_Revert('ALL')">
				Undo change
			</button>
		</div>
	</div>
	<div id="myProgress">
		<div id="myBar">
		</div>
	</div>
	<script language="JavaScript" type="text/javascript">
		WshShell = new ActiveXObject("WScript.Shell");
		FsObj = new ActiveXObject("Scripting.FileSystemObject");
		
		function RUN_eclipse() {
		
		//if (FsObj.FolderExists("C:\\Users\\p11950\\Downloads\\jbpm\\")) {alert("ça marche !")};
		
		WshShell.Run("C:\\Users\\p11950\\Downloads\\jbpm\\run-eclipse.bat ");
		
		}
		
		function SVN_Revert(So) {
			var StressR = document.getElementById("id_stress2").value;
			var PrFr = PROD_From.checked;
			var PrTo = PROD_To.checked;
			var AcFr = ACC_From.checked;
			var AcTo = ACC_To.checked;
			var InFr = INT_From.checked;
			var InTo = INT_To.checked;
			var PrFrD = PROD_FromD.checked;
			var PrToD = PROD_ToD.checked;
			var AcFrD = ACC_FromD.checked;
			var AcToD = ACC_ToD.checked;
			var InFrD = INT_FromD.checked;
			var InToD = INT_ToD.checked;
			
			if (So == "ALL") {
			
				if (PrToD == true){WshShell.Run("TortoiseCommit.bat " + " " + StressR + " " + "ALL" + " " + "0" + " " + "1" + " " + "0" + " " + "1" );};
				if (AcToD == true){WshShell.Run("TortoiseCommit.bat " + " " + StressR + " " + "ALL" + " " + "0" + " " + "1" + " " + "0" + " " + "2" );};
				if (InToD == true){WshShell.Run("TortoiseCommit.bat " + " " + StressR + " " + "ALL" + " " + "0" + " " + "1" + " " + "0" + " " + "3" );};
			
			} else {
				if (AcTo == true) {WshShell.Run("TortoiseCommit.bat " + " " + StressR + " " + "ACC" + " " + "0" + " " + "1" + " " + "0" + " " + "0" ); };
				if (PrTo == true) {WshShell.Run("TortoiseCommit.bat " + " " + StressR + " " + "PROD" + " " + "0" + " " + "1" + " " + "0" + " " + "0" ); };
				if (InTo == true) {WshShell.Run("TortoiseCommit.bat " + " " + StressR + " " + "INT" + " " + "0" + " " + "1" + " " + "0" + " " +"0" ); };	
			}
		}
		
		function SVN_Migration() {
			var StressF = document.getElementById("id_stress2").value;
			// var FolderCheck = if (AcTo == true && InFr == true) {FsObj.CopyFolder(".\\INT\\SolvencyII\\" + StressF + "\\branches\\groupe1\\RUN1\\*", ".\\ACC\\SolvencyII\\" + StressF + "\\branches\\groupe1\\RUN1\\"); };
			var PrFr = PROD_From.checked;
			var PrTo = PROD_To.checked;
			var AcFr = ACC_From.checked;
			var AcTo = ACC_To.checked;
			var InFr = INT_From.checked;
			var InTo = INT_To.checked;

			
			if (confirm("As tu fait un update avant ?")) {
			
				if (PrFr == false && PrTo == false && AcFr == false && AcTo == false && InFr == false && InTo == false) {
				
				alert("Choissisez un environnement !")
				
				} else if (PrFr == false && AcFr == false && InFr == false){
				
				alert("Choissisez un environnement source !")
				
				} else if (PrTo == false && AcTo == false && InTo == false){
				
				alert("Choissisez un environnement cible !")
				
				} else if (FsObj.FolderExists(".\\INT\\SolvencyII\\" + StressF + "\\branches\\groupe1\\RUN1\\") == false && FsObj.FolderExists(".\\ACC\\SolvencyII\\" + StressF + "\\branches\\groupe1\\RUN1\\") == false && FsObj.FolderExists(".\\PROD\\SolvencyII\\" + StressF + "\\branches\\groupe1\\RUN1\\") == false){
				
				alert("Le chemin n'existe pas !")
				
				} else {
				
				var id = setInterval(frame, 10);
				var elem = document.getElementById("myBar");
				var width = 10;
				var val = [			
					function() { if (AcTo == true && InFr == true) {FsObj.CopyFolder(".\\INT\\SolvencyII\\" + StressF + "\\branches\\groupe1\\RUN1\\*", ".\\ACC\\SolvencyII\\" + StressF + "\\branches\\groupe1\\RUN1\\"); }; },
					function() { if (PrTo == true && InFr == true) {FsObj.CopyFolder(".\\INT\\SolvencyII\\" + StressF + "\\branches\\groupe1\\RUN1\\*", ".\\PROD\\SolvencyII\\" + StressF + "\\branches\\groupe1\\RUN1\\"); }; },
					function() { if (InTo == true && AcFr == true) {FsObj.CopyFolder(".\\ACC\\SolvencyII\\" + StressF + "\\branches\\groupe1\\RUN1\\*", ".\\INT\\SolvencyII\\" + StressF + "\\branches\\groupe1\\RUN1\\"); }; },
					function() { if (PrTo == true && AcFr == true) {FsObj.CopyFolder(".\\ACC\\SolvencyII\\" + StressF + "\\branches\\groupe1\\RUN1\\*", ".\\PROD\\SolvencyII\\" + StressF + "\\branches\\groupe1\\RUN1\\"); }; },
					function() { if (InTo == true && PrFr == true) {FsObj.CopyFolder(".\\PROD\\SolvencyII\\" + StressF + "\\branches\\groupe1\\RUN1\\*", ".\\INT\\SolvencyII\\" + StressF + "\\branches\\groupe1\\RUN1\\"); }; },
					function() { if (AcTo == true && PrFr == true) {FsObj.CopyFolder(".\\PROD\\SolvencyII\\" + StressF + "\\branches\\groupe1\\RUN1\\*", ".\\ACC\\SolvencyII\\" + StressF + "\\branches\\groupe1\\RUN1\\"); }; },
				];
				var i = 0;
				if (AcTo == true) {WshShell.Run("TortoiseCommit.bat " + " " + StressF + " " + "ACC" + " " + "0" + " " + "0" + " " + "1" + " " + "0" ); };
				if (PrTo == true) {WshShell.Run("TortoiseCommit.bat " + " " + StressF + " " + "PROD" + " " + "0" + " " + "0" + " " + "1" + " " + "0" ); };
				if (InTo == true) {WshShell.Run("TortoiseCommit.bat " + " " + StressF + " " + "INT" + " " + "0" + " " + "0" + " " + "1" + " " + "0" ); };	
				function frame() {
					if (width >= 100) {
						width = 100;
						elem.style.width = width + '%';
						elem.innerHTML = width * 1 + '%';				
						clearInterval(id);
					} else if (i < 6) {
						val[i]();
						width = width + 10;
						elem.style.width = width + '%';
						elem.innerHTML = width * 1 + '%';
						i++;				
					
					} else {
						width = 100;
						elem.style.width = width + '%';
						elem.innerHTML = width * 1 + '%';					
					
					}	
				}
				}
			
			} else {
			
			//var update = document.getElementById("Update");
			
			//update.style.cssText = "color:white;background-color:red;";
			//update.style.backgroundColor = "red";
						
			} 
		}
		
		function SVN_Deploy() {
			// var StressFD = document.getElementById("id_stress3").value;
			// var FolderCheck = if (AcTo == true && InFr == true) {FsObj.CopyFolder(".\\INT\\SolvencyII\\" + StressF + "\\branches\\groupe1\\RUN1\\*", ".\\ACC\\SolvencyII\\" + StressF + "\\branches\\groupe1\\RUN1\\"); };
			var PrFrD = PROD_FromD.checked;
			var PrToD = PROD_ToD.checked;
			var AcFrD = ACC_FromD.checked;
			var AcToD = ACC_ToD.checked;
			var InFrD = INT_FromD.checked;
			var InToD = INT_ToD.checked;
			
			if (confirm("As tu fait un update avant ?")) {
			
				if (PrFrD == false && PrToD == false && AcFrD == false && AcToD == false && InFrD == false && InToD == false) {
				
				alert("Choissisez un environnement !")
				
				} else if (PrFrD == false && AcFrD == false && InFrD == false){
				
				alert("Choissisez un environnement source !")
				
				} else if (PrToD == false && AcToD == false && InToD == false){
				
				alert("Choissisez un environnement cible !")
				
				} else if (FsObj.FolderExists(".\\INT\\SolvencyII\\") == false || FsObj.FolderExists(".\\ACC\\SolvencyII\\") == false || FsObj.FolderExists(".\\PROD\\SolvencyII\\") == false){
				
				alert("Le chemin n'existe pas !")
				
				} else {
					//Déclaration variables
					var id = setInterval(frame, 10);
					var elem = document.getElementById("myBar");
					var width = 10;
					var Stress = ["BE_VIE","BE_VIE_ACT","BE_VIE_ACT_1000SIM","BE_VIE_ACT_NOVA","BE_VIE_ACT_NOVA_1000SIM","BE_VIE_BLANK_RUN","BE_VIE_CBG","BE_VIE_CBG_1000SIM","BE_VIE_CBG_NOVA","BE_VIE_CBG_NOVA_1000SIM","BE_VIE_NOVA","CALC_EPIFP_CBG","CALC_EPIFP_PSGL","LAT_BEGAAP","LAT_IFRS","RENTES_DC","SCR_INT_ACT"];
					//var i = 0;
					var s = 0;
					//Logs
					if (AcToD == true) {WshShell.Run("TortoiseCommit.bat " + " " + "ALL" + " " + "ACC" + " " + "0" + " " + "0" + " " + "1" + " " + "0" ); };
					if (PrToD == true) {WshShell.Run("TortoiseCommit.bat " + " " + "ALL" + " " + "PROD" + " " + "0" + " " + "0" + " " + "1" + " " + "0" ); };
					if (InToD == true) {WshShell.Run("TortoiseCommit.bat " + " " + "ALL" + " " + "INT" + " " + "0" + " " + "0" + " " + "1" + " " + "0" ); };
					//Instance fonction de copie
					function CopyS(stre) {
						if (AcToD == true && InFrD == true) {FsObj.CopyFolder(".\\INT\\SolvencyII\\" + stre + "\\branches\\groupe1\\RUN1\\*", ".\\ACC\\SolvencyII\\" + stre + "\\branches\\groupe1\\RUN1\\");};
						if (PrToD == true && InFrD == true) {FsObj.CopyFolder(".\\INT\\SolvencyII\\" + stre + "\\branches\\groupe1\\RUN1\\*", ".\\PROD\\SolvencyII\\" + stre + "\\branches\\groupe1\\RUN1\\");};
						if (InToD == true && AcFrD == true) {FsObj.CopyFolder(".\\ACC\\SolvencyII\\" + stre + "\\branches\\groupe1\\RUN1\\*", ".\\INT\\SolvencyII\\" + stre + "\\branches\\groupe1\\RUN1\\");};
						if (PrToD == true && AcFrD == true) {FsObj.CopyFolder(".\\ACC\\SolvencyII\\" + stre + "\\branches\\groupe1\\RUN1\\*", ".\\PROD\\SolvencyII\\" + stre + "\\branches\\groupe1\\RUN1\\");};
						if (InToD == true && PrFrD == true) {FsObj.CopyFolder(".\\PROD\\SolvencyII\\" + stre + "\\branches\\groupe1\\RUN1\\*", ".\\INT\\SolvencyII\\" + stre + "\\branches\\groupe1\\RUN1\\");};
						if (AcToD == true && PrFrD == true) {FsObj.CopyFolder(".\\PROD\\SolvencyII\\" + stre + "\\branches\\groupe1\\RUN1\\*", ".\\ACC\\SolvencyII\\" + stre + "\\branches\\groupe1\\RUN1\\");};
					}
					//Instance et boucle de la fonction d'éxécution princiaple
					function frame() {
						if (width >= 100) {
							width = 100;
							elem.style.width = width + '%';
							elem.innerHTML = width * 1 + '%';				
							clearInterval(id);
						} else if (s < 17) {
							CopyS(Stress[s]);
							width = width + 10;
							elem.style.width = width + '%';
							elem.innerHTML = width * 1 + '%';
							//i++;
							s++;
						
						} else {
							width = 100;
							elem.style.width = width + '%';
							elem.innerHTML = width * 1 + '%';					
						
						}	
					}
				}
			} else {
			
			//var update = document.getElementById("Update");
			
			//update.style.cssText = "color:white;background-color:red;";
			//update.style.backgroundColor = "red";
						
			}
			if (PrToD == true) {WshShell.Run("Clean.bat " + "Depl" + " " + "1" + " " + "0" + " " + "0"); };
			if (AcToD == true) {WshShell.Run("Clean.bat " + "Depl" + " " + "0" + " " + "1" + " " + "0"); };
			if (InToD == true) {WshShell.Run("Clean.bat " + "Depl" + " " + "0" + " " + "0" + " " + "1"); };
		}
		
		function SVN_Clean() {
			<!-- WshShell.ConnectServer("153.89.39.187", "root\cimv2", "Adminstall", "@dm1nst@ll"); -->
			<!-- Wscript.Echo "Executing" & "D:\groups\ACC\BATCH\94.Sandbox\SignOff\test.bat"; -->
			<!-- WshShell.CurrentDirectory = "D:\groups\ACC\BATCH\94.Sandbox\SignOff\"; -->
			var repo1 = document.getElementById("id_stress").value;
			var envirProd = PROD_Input.checked;
			var envirAcc = ACC_Input.checked;
			var envirInt = INT_Input.checked;
			
			if (envirProd == false && envirAcc == false && envirInt == false){
			
			alert("choissisez un environnement !")
			
			} else {
			
			WshShell.Run("Clean.bat " + repo1 + " " + envirProd + " " + envirAcc + " " + envirInt);			
			
			}
			<!-- WshShell.Run("Clean.bat " + repo1 + " " + env); -->
		}

		function SVN_Commit() {
			<!-- WshShell.CurrentDirectory = "D:\\projet"; -->
			<!-- WshShell.Run("test.bat"); -->

			<!-- var env = document.getElementById("envie").value; -->
			<!-- WshShell.Run("TortoiseCommit " + repo2 + " " + env); -->
			var repo2 = document.getElementById("id_stress").value;
			var envirProd = PROD_Input.checked;
			var envirAcc = ACC_Input.checked;
			var envirInt = INT_Input.checked;
			
			if (envirProd == false && envirAcc == false && envirInt == false){
			
			alert("choissisez un environnement !")
			
			} else {
			
			if (envirProd == true) { WshShell.Run("TortoiseCommit.bat " + " " + repo2 + " " + "PROD" + " " + "0" + " " + "0" + " " + "0" + " " + "0" ); };
			if (envirAcc == true) { WshShell.Run("TortoiseCommit.bat " + " " + repo2 + " " + "ACC" + " " + "0" + " " + "0" + " " + "0" + " " + "0" ); };
			if (envirInt == true) { WshShell.Run("TortoiseCommit.bat " + " " + repo2 + " " + "INT" + " " + "0" + " " + "0" + " " + "0" + " " + "0" ); };
			
			}			
			<!-- WshShell.Run("TortoiseCommit " + " " + repo2 + " " + envirProd + " " + envirAcc + " " + envirInt); -->
		}
		
		function SVN_Update() {
		
			var repo2 = document.getElementById("id_stress").value;		
			var envirProd = PROD_Input.checked;
			var envirAcc = ACC_Input.checked;
			var envirInt = INT_Input.checked;
			//var update = document.getElementById("Update");
			//var css = document.createTextNode("#Update:hover { background-color: #FF5A10; }");
			//var styleCH = document.createElement("style");
			
			//styleCH.appendChild(css);
			//document.style.appendChild(css);
			//update.style.color = "#000000";
			//update.style.backgroundColor = "#f0f0f0";
			
			if (envirProd == false && envirAcc == false && envirInt == false){
			
			alert("choissisez un environnement !")
			
			} else {
			
			if (envirProd == true) { WshShell.Run("TortoiseCommit.bat " + " " + repo2 + " " + "PROD" + " " + "1" + " " + "0" + " " + "0" + " " + "0" ); };
			if (envirAcc == true) { WshShell.Run("TortoiseCommit.bat " + " " + repo2 + " " + "ACC" + " " + "1" + " " + "0" + " " + "0" + " " + "0" ); };
			if (envirInt == true) { WshShell.Run("TortoiseCommit.bat " + " " + repo2 + " " + "INT" + " " + "1" + " " + "0" + " " + "0" + " " + "0" ); };		
			
			}
		}
	</script>
</body>
</html> 